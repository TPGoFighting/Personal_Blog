{% extends 'blog/base.html' %}
{% block content %}
  <div class="container py-5 mt-5">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card border-0 shadow-sm rounded-4 p-4 mb-4 bg-white">
          <h3 class="fw-bold mb-4"><i class="bi bi-chat-dots me-2 text-primary"></i>发表留言</h3>
          <form method="post">
            {% csrf_token %}
            <div class="mb-3">
              <label class="form-label small fw-bold">你的昵称</label>
              <input type="text" name="user" class="form-control" placeholder="输入称呼..." required />
            </div>
            <div class="mb-3">
              <label class="form-label small fw-bold">内容</label>
              <textarea name="content" class="form-control" rows="4" placeholder="想说的话..." required></textarea>
            </div>
            <button type="submit" class="btn btn-primary rounded-pill px-4">提交留言</button>
          </form>
        </div>

        <div class="card border-0 shadow-sm rounded-4 p-4 bg-white">
          <h5 class="mb-4 text-secondary">{{ messages.count }} 条留言</h5>
          {% for m in messages %}
            <div class="d-flex mb-4 pb-3 {% if not forloop.last %}border-bottom{% endif %}">
              <div class="flex-shrink-0">
                <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 45px; height: 45px; font-weight: bold;">{{ m.user|slice:':1'|upper }}</div>
              </div>
              <div class="flex-grow-1 ms-3">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <strong class="text-dark">{{ m.user }}</strong>
                  <small class="text-muted">{{ m.created_at|date:'Y-m-d H:i' }}</small>
                </div>
                <p class="mb-0 text-secondary" style="line-height: 1.6;">{{ m.content }}</p>
              </div>
            </div>
          {% empty %}
            <div class="text-center py-5">
              <i class="bi bi-chat-quote display-1 text-light"></i>
              <p class="text-muted mt-3">暂无留言，快来抢沙发吧！</p>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}
